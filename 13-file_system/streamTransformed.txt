'USE STRICT'
CONST {PIPELINE, TRANSFORM} = REQUIRE('STREAM')
CONST { JOIN } = REQUIRE('PATH')
CONST { CREATEREADSTREAM, CREATEWRITESTREAM } = REQUIRE('FS')

PIPELINE(
    CREATEREADSTREAM(__FILENAME),
    CREATEWRITESTREAM(JOIN(__DIRNAME,'STREAM.TXT')),(ERR)=>{
        IF(ERR){
            CONSOLE.ERROR(ERR)
            RETURN
        }
        CONSOLE.LOG('FINISHED WRITING')
    }
)

// WITH TRANSFORM STREAM

CONST CREATETRANSFORMSTREAM = ()=>{
    RETURN NEW TRANSFORM({
        TRANSFORM(CHUNK,ENCOD,NEXT){
            CONST UPPERCASED = CHUNK.TOSTRING().TOUPPERCASE()
            NEXT(NULL, UPPERCASED)
        }
    })
}
PIPELINE(
    CREATEREADSTREAM(__FILENAME),
    CREATETRANSFORMSTREAM(),
    CREATEWRITESTREAM(JOIN(__DIRNAME,'STREAMTRANSFORMED.TXT')),(ERR)=>{
        IF(ERR){
            CONSOLE.ERROR(ERR)
            RETURN
        }
        CONSOLE.LOG('FINISHED WRITING')
    }
)